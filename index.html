<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>PostgreSQL</title>
</head>
<body>
    <h1>PostgreSQL</h1>
    <p>Assignment 1</p>
    <p>
        <a href="javascript:cmd(1);">cmd1</a><br>
        <a href="javascript:cmd(2);">cmd2</a><br>
    </p>
    <p>
        <input type="text" id="manual_query"><a href="javascript:manual_query();">submit</a><br>
    </p>
    <table>
        <tbody id="tbody"></tbody>
    </table>
</body>
<script src="/socket.io/socket.io.js"></script>
<script>
    var socket = io.connect();

    //- Socket.io Commands
    function cmd(id) { socket.emit('cmd', id); }
    function manual_query() {
        var query = document.getElementById('manual_query').value;
        socket.emit('manual_query', query);
    }

    //- Socket.io Responses
    socket.on('response', function (data) {
        console.log("response incoming");
        var resHtml = "";
        for (var r in data) {
            resHtml += "<tr>";
            for (var c in data[r])
                resHtml += "<td>"+data[r][c]+"</td>";
            resHtml += "</tr>";
        }
        document.getElementById('tbody').innerHTML = resHtml;
    });

    //- Let's get this party started
    cmd(1);

</script>
</html>
